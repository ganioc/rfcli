"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
const bignumber_js_1 = require("bignumber.js");
/**
 * 付出e,能够购买
多少个Token?
R增加了e
S增加了s, T = S0( (1+ e/R0)^F -1)

卖出s个Token, 能够
R减少多少个e, E = R0(1- (1- s/S0)^(1/F) )
S减少了s, s个

exponentiatedBy(n: number, m?: BigNumberValue): BigNumber;
pow(), 最小的单元是多少呢？

SYS的最小单位是多少？10^-6就可以了吧？默认是小数点后18位

minus()
plus()
minus()
multipliedBy()
.toFixed(6)
dividedby()

 */
console.log('Test bancor');
let R = new bignumber_js_1.BigNumber(250); // reserve
let S = new bignumber_js_1.BigNumber(1000); // supply
let F = 0.5;
let invF = 1 / F;
let funcBuy = (inE) => {
    let e = new bignumber_js_1.BigNumber(inE);
    let out;
    out = e.dividedBy(R);
    out = out.plus(new bignumber_js_1.BigNumber(1.0));
    // out = out.exponentiatedBy(F);
    let temp1 = out.toNumber();
    out = new bignumber_js_1.BigNumber(Math.pow(temp1, F));
    out = out.minus(new bignumber_js_1.BigNumber(1));
    out = out.multipliedBy(S);
    // out = out.toFixed(12);
    R = R.plus(e);
    S = S.plus(out);
    console.log('Buy ', e.toFixed(12), ' sys of token', out.toFixed(12));
    return out;
};
let funcSell = (inT) => {
    let e = new bignumber_js_1.BigNumber(inT);
    let out;
    out = e.dividedBy(S);
    out = new bignumber_js_1.BigNumber(1).minus(out);
    let temp1 = out.toNumber();
    out = new bignumber_js_1.BigNumber(Math.pow(temp1, invF));
    out = new bignumber_js_1.BigNumber(1).minus(out);
    out = out.multipliedBy(R);
    R = R.minus(out);
    S = S.minus(e);
    console.log('Sell ', e.toFixed(12), ' token to get:', out.toFixed(12));
    return out;
};
let funcSell2 = (inT) => {
    let t = new bignumber_js_1.BigNumber(inT);
    let out;
    out = R.toNumber() * (1 - Math.pow(1 - inT / S.toNumber(), invF));
    R = R.minus(new bignumber_js_1.BigNumber(out));
    S = S.minus(new bignumber_js_1.BigNumber(inT));
    return out;
};
let funcBuy2 = (inE) => {
    let out;
    out = 1000 * (Math.pow(1 + inE / R.toNumber(), F) - 1);
    R = R.plus(new bignumber_js_1.BigNumber(out));
    S = S.plus(new bignumber_js_1.BigNumber(inE));
    return out;
};
let printRS = () => {
    console.log('_'.repeat(40));
    console.log('Reserve:', R.toFixed(12));
    console.log('Supply:', S.toFixed(12));
    console.log('-'.repeat(40));
};
// let T = funcBuy(0.5);
// console.log(T.toNumber());
// let T2 = funcBuy2(0.5);
// console.log(T2);
let test1 = () => {
    printRS();
    let T = funcBuy(0.5);
    let E = funcSell(T);
    printRS();
    T = funcBuy(250);
    printRS();
    E = funcSell(T);
    printRS();
    E = funcSell(1000);
    printRS();
};
let test2 = () => {
    printRS();
    let T = funcBuy2(0.5);
    console.log('Buy ', 0.5, ' sys of token', T);
    let E = funcSell2(T);
    console.log('Sell ', T, ' token to get:', E);
    printRS();
};
let test3 = () => {
    let n = new bignumber_js_1.BigNumber("n1000");
    console.log(n.toString());
};
test1();
// console.log("\nTest2\n");
// test3();
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoidGVzdGJhbmNvci5qcyIsInNvdXJjZVJvb3QiOiIiLCJzb3VyY2VzIjpbIi4uLy4uL3NyYy90ZXN0L3Rlc3RiYW5jb3IudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6Ijs7QUFBQSwrQ0FBeUM7QUFFekM7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7R0FzQkc7QUFFSCxPQUFPLENBQUMsR0FBRyxDQUFDLGFBQWEsQ0FBQyxDQUFDO0FBRTNCLElBQUksQ0FBQyxHQUFHLElBQUksd0JBQVMsQ0FBQyxHQUFHLENBQUMsQ0FBQyxDQUFFLFVBQVU7QUFDdkMsSUFBSSxDQUFDLEdBQUcsSUFBSSx3QkFBUyxDQUFDLElBQUksQ0FBQyxDQUFDLENBQUMsU0FBUztBQUN0QyxJQUFJLENBQUMsR0FBRyxHQUFHLENBQUM7QUFDWixJQUFJLElBQUksR0FBRyxDQUFDLEdBQUcsQ0FBQyxDQUFDO0FBRWpCLElBQUksT0FBTyxHQUFHLENBQUMsR0FBdUIsRUFBYSxFQUFFO0lBQ2pELElBQUksQ0FBQyxHQUFHLElBQUksd0JBQVMsQ0FBQyxHQUFHLENBQUMsQ0FBQztJQUMzQixJQUFJLEdBQWMsQ0FBQztJQUVuQixHQUFHLEdBQUcsQ0FBQyxDQUFDLFNBQVMsQ0FBQyxDQUFDLENBQUMsQ0FBQztJQUNyQixHQUFHLEdBQUcsR0FBRyxDQUFDLElBQUksQ0FBQyxJQUFJLHdCQUFTLENBQUMsR0FBRyxDQUFDLENBQUMsQ0FBQztJQUNuQyxnQ0FBZ0M7SUFDaEMsSUFBSSxLQUFLLEdBQUcsR0FBRyxDQUFDLFFBQVEsRUFBRSxDQUFDO0lBQzNCLEdBQUcsR0FBRyxJQUFJLHdCQUFTLENBQUMsSUFBSSxDQUFDLEdBQUcsQ0FBQyxLQUFLLEVBQUUsQ0FBQyxDQUFDLENBQUMsQ0FBQztJQUN4QyxHQUFHLEdBQUcsR0FBRyxDQUFDLEtBQUssQ0FBQyxJQUFJLHdCQUFTLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQztJQUNsQyxHQUFHLEdBQUcsR0FBRyxDQUFDLFlBQVksQ0FBQyxDQUFDLENBQUMsQ0FB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